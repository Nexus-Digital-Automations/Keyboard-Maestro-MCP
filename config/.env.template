# Keyboard Maestro MCP Server Environment Configuration Template
# Copy this file to .env in the project root and customize the values

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# Transport Protocol (stdio|streamable-http)
KM_MCP_TRANSPORT=stdio

# Server Host (use 0.0.0.0 for production, 127.0.0.1 for development)
KM_MCP_HOST=127.0.0.1

# Server Port
KM_MCP_PORT=8080

# Development Mode (true|false)
KM_MCP_DEV_MODE=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Authentication Required (true|false)
KM_MCP_AUTH_REQUIRED=false

# JWT Secret Key (REQUIRED for production - generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
KM_MCP_JWT_SECRET_KEY=your-generated-secret-key-here

# JWT Algorithm
KM_MCP_JWT_ALGORITHM=HS256

# JWT Token Expiration (seconds)
KM_MCP_JWT_EXPIRATION=3600

# JWT Issuer
KM_MCP_JWT_ISSUER=keyboard-maestro-mcp

# JWT Audience
KM_MCP_JWT_AUDIENCE=mcp-clients

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================

# Maximum Concurrent Operations
KM_MCP_MAX_CONCURRENT_OPERATIONS=50

# Operation Timeout (seconds)
KM_MCP_OPERATION_TIMEOUT=30

# Request Timeout (seconds)
KM_MCP_REQUEST_TIMEOUT=60

# Keep-alive Timeout (seconds)
KM_MCP_KEEPALIVE_TIMEOUT=65

# Maximum Request Size (bytes)
KM_MCP_MAX_REQUEST_SIZE=10485760

# =============================================================================
# RESOURCE LIMITS
# =============================================================================

# Memory Limit (MB)
KM_MCP_MEMORY_LIMIT=512

# CPU Limit (cores)
KM_MCP_CPU_LIMIT=2.0

# Disk Usage Limit (MB)
KM_MCP_DISK_USAGE_LIMIT=1024

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log Level (DEBUG|INFO|WARNING|ERROR|CRITICAL)
KM_MCP_LOG_LEVEL=INFO

# Log Format (text|json)
KM_MCP_LOG_FORMAT=json

# Log to Console (true|false)
KM_MCP_LOG_CONSOLE=true

# Log File Path
KM_MCP_LOG_FILE=logs/km-mcp-server.log

# Log Rotation Enabled (true|false)
KM_MCP_LOG_ROTATION=true

# Log File Max Size
KM_MCP_LOG_MAX_SIZE=10MB

# Log Backup Count
KM_MCP_LOG_BACKUP_COUNT=5

# Log Compression (true|false)
KM_MCP_LOG_COMPRESSION=true

# =============================================================================
# ERROR HANDLING & MONITORING
# =============================================================================

# Error Reporting Enabled (true|false)
KM_MCP_ERROR_REPORTING=false

# Sentry DSN (for error tracking - optional)
KM_MCP_SENTRY_DSN=your-sentry-dsn-here

# Error Environment Tag
KM_MCP_ERROR_ENVIRONMENT=development

# Metrics Enabled (true|false)
KM_MCP_METRICS_ENABLED=true

# Metrics Port
KM_MCP_METRICS_PORT=9090

# Health Check Enabled (true|false)
KM_MCP_HEALTH_CHECK_ENABLED=true

# Health Check Interval (seconds)
KM_MCP_HEALTH_CHECK_INTERVAL=30

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate Limiting Enabled (true|false)
KM_MCP_RATE_LIMITING_ENABLED=false

# Global Requests Per Minute
KM_MCP_GLOBAL_REQUESTS_PER_MINUTE=100

# Global Burst Limit
KM_MCP_GLOBAL_BURST=20

# Per-Client Requests Per Minute
KM_MCP_CLIENT_REQUESTS_PER_MINUTE=10

# Per-Client Burst Limit
KM_MCP_CLIENT_BURST=5

# =============================================================================
# KEYBOARD MAESTRO INTEGRATION
# =============================================================================

# Keyboard Maestro Engine Path
KM_MCP_KM_ENGINE_PATH=/Applications/Keyboard Maestro.app

# Keyboard Maestro Timeout (seconds)
KM_MCP_KM_TIMEOUT=30

# Verify Keyboard Maestro Connection (true|false)
KM_MCP_KM_VERIFY_CONNECTION=true

# AppleScript Pool Size
KM_MCP_APPLESCRIPT_POOL_SIZE=10

# AppleScript Pool Timeout (seconds)
KM_MCP_APPLESCRIPT_POOL_TIMEOUT=60

# AppleScript Retry Attempts
KM_MCP_APPLESCRIPT_RETRY_ATTEMPTS=3

# =============================================================================
# SYSTEM INTEGRATION
# =============================================================================

# Check Accessibility on Startup (true|false)
KM_MCP_CHECK_ACCESSIBILITY_STARTUP=true

# Periodic Accessibility Validation (true|false)
KM_MCP_PERIODIC_ACCESSIBILITY_CHECK=true

# Accessibility Validation Interval (seconds)
KM_MCP_ACCESSIBILITY_CHECK_INTERVAL=300

# Sandbox Mode (true|false)
KM_MCP_SANDBOX_MODE=false

# Script Execution Timeout (seconds)
KM_MCP_SCRIPT_TIMEOUT=30

# Script Memory Limit (MB)
KM_MCP_SCRIPT_MEMORY_LIMIT=64

# =============================================================================
# DEVELOPMENT OVERRIDES
# =============================================================================

# Development Mode Overrides (only active when KM_MCP_DEV_MODE=true)

# Override Log Level in Development
KM_MCP_DEV_LOG_LEVEL=DEBUG

# Override Auth Required in Development
KM_MCP_DEV_AUTH_REQUIRED=false

# Override Rate Limiting in Development
KM_MCP_DEV_RATE_LIMITING=false

# Override Host in Development
KM_MCP_DEV_HOST=127.0.0.1

# Override Port in Development
KM_MCP_DEV_PORT=8000

# =============================================================================
# PRODUCTION-SPECIFIC SETTINGS
# =============================================================================

# Domain Name (for production deployment)
KM_MCP_DOMAIN=

# SSL Configuration
KM_MCP_SSL_ENABLED=false
KM_MCP_SSL_CERT_FILE=
KM_MCP_SSL_KEY_FILE=

# Administrator Email
KM_MCP_ADMIN_EMAIL=

# Backup Configuration
KM_MCP_BACKUP_ENABLED=false
KM_MCP_BACKUP_DIRECTORY=backup/
KM_MCP_BACKUP_RETENTION_DAYS=30

# =============================================================================
# INSTRUCTIONS
# =============================================================================

# 1. Copy this file to .env in the project root:
#    cp config/.env.template .env

# 2. Generate a secure JWT secret key:
#    python -c "import secrets; print(f'KM_MCP_JWT_SECRET_KEY={secrets.token_urlsafe(32)}')"

# 3. Set appropriate values for your environment:
#    - Development: Keep defaults, set KM_MCP_DEV_MODE=true
#    - Production: Review all settings, generate secrets, set KM_MCP_DEV_MODE=false

# 4. Set secure file permissions:
#    chmod 600 .env

# 5. Validate configuration:
#    python scripts/validation/production_validator.py

# =============================================================================
# SECURITY NOTES
# =============================================================================

# - Never commit the .env file to version control
# - Use strong, unique secret keys for production
# - Review and restrict file permissions (600 for .env)
# - Enable authentication for production deployments
# - Configure proper firewall rules for network access
# - Regularly rotate secret keys and credentials
